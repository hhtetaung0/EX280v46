# EX288 v410
The Red Hat Certified Specialist in OpenShift Application Development exam (EX288) tests your ability to deploy existing applications in a Red Hat® OpenShift® Container Platform environment.

To help you prepare, the exam objectives highlight the task areas you can expect to see covered in the exam. Red Hat reserves the right to add, modify, and remove exam objectives. Such changes will be made public in advance.

As part of this exam, you should be able to perform these tasks:

## Work with Red Hat OpenShift Container Platform
  - Create and work with multiple OpenShift projects
  - Deploy single container and multi-container applications
  - Create and use a Helm chart
  - Customize deployments with Kustomize
  - Implement application health monitoring
  - Understand basic Git usage and work with Git in the context of deploying applications in OpenShift
  - Configure the OpenShift internal registry to meet specific requirements
  - Create and deploy cloud-native applications for OpenShift
  - Manage applications with the web console


## Deploy multi-container applications
- Create Helm charts
  - Chart.yaml: Holds the Chart definition information.
  - values.yaml: Holds the values that Helm uses in the default and user-created templates.
  - templates:
```diff
# helm create appname

# cd appname
# tree .
.
├── charts
├── Chart.yaml
├── templates
│   ├── deployment.yaml
│   ├── _helpers.tpl
│   ├── hpa.yaml
│   ├── ingress.yaml
│   ├── NOTES.txt
│   ├── serviceaccount.yaml
│   ├── service.yaml
│   └── tests
│       └── test-connection.yaml
└── values.yaml

# cat Chart.yaml
apiVersion: v2
name: mychart
description: A Helm chart for Kubernetes
type: application
version: 0.1.0
appVersion: "1.0.0"
dependencies:
  - name: dependency1
    version: 1.2.3
    repository: https://examplerepo.com/charts
    
# cat values.yaml

// Downloads the charts added as dependencies and locks its versions.
# helm dependency update

# helm install appname .

# helm list
# helm uninstall appname

```
- Customizing deployments with Kustomize
```diff
// Deploy application with kustomization.yaml
# cat base/kustomization.yaml
resources:
- 1_deployment.yaml
- 2_services.yaml

# oc create -k base

// Apply the deployment overlay to application
# cat overlays/dev/kustomization.yaml
bases:
- ../../base
patches:
- replica_limits.yaml

# oc apply -k overlays/dev

```

## Work with container images

- Use command line utilities to create and manipulate container images
```diff
# cat container-build/Containerfile
FROM quay.io/redhattraining/http-parent

```

- Optimize container images
```diff
# cat container-build/Containerfile
FROM quay.io/redhattraining/http-parent

EXPOSE 8080
LABEL io.k8s.description="A basic Apache HTTP Server child image, uses ONBUILD" \
      io.k8s.display-name="Apache HTTP Server" \
      io.openshift.expose-services="8080:http" \
      io.openshift.tags="apache, httpd"

RUN sed -i "s/Listen 80/Listen 8080/g" /etc/httpd/conf/httpd.conf && \
    sed -i "s/#ServerName www.example.com:80/ServerName 0.0.0.0:8080/g"  /etc/httpd/conf/httpd.conf && \
    chgrp -R 0 /var/log/httpd /var/run/httpd && \
    chmod -R g=u /var/log/httpd /var/run/httpd
    
USER 1001

# git commit -a -m "comment"
# git push

```

### Publish container images to a registry

- Using podman to build and publish
```diff
# podman build --layers=false -t tagname ./container-build
# podman tag do288-apache quay.io/yangzhengtx/do288-apache

# podman login -u yangzhengtx quay.io
# podman push --format v2s1 quay.io/yangzhengtx/do288-apache

# oc new-app --name hola quay.io/yangzhengtx/do288-apache

```

- Using skopeo to manage container registry
```diff
# skopeo copy --dest-tls-verify=false \
              oci:/home/user/myimage   docker://registry.example.com/myorg/myimage

# skopeo copy --dest-tls-verify=false \
              containers-storage:myimage   docker://registry.example.com/myorg/myimage
              
# skopeo copy --src-creds=testuser:testpassword  --dest-creds=testuser1:testpassword \
              docker://srcregistry.domain.com/org1/private   docker://dstegistry.domain2.com/org2/private

# skopeo delete docker://srcregistry.domain.com/org1/private 
```

### Working with External Registry
```
// Login quay.io by using podman and personal credentials.
# podman login -u yangzhengtx quay.io
Password:
Login Succeeded!

// Copy image to external registry
# skopeo copy --format v2s1 oci:/home/student/DO288/labs/external-registry/ubi-sleep \
  docker://quay.io/yangzhengtx/ubi-sleep:1.0
  
// Create a secret from the container registry API access token that was stored by Podman
# oc create secret generic quayio --from-file .dockerconfigjson=/run/user/1000/containers/auth.json \
  --type kubernetes.io/dockerconfigjson
secret/quayio created

Or
# oc create secret docker-registry registrycreds --docker-server registry.example.com \
  --docker-username youruser  --docker-password yourpassword

// Link secret to SA default, so that Openshift is able to access external registry.
# oc secrets link default quayio --for pull

// Deploy application
# oc new-app --name sleep --image quay.io/yangzhengtx/ubi-sleep:1.0
```

### Working with Openshift Registry
```
// Enable default route for Openshift internal Registry
# oc patch config.imageregistry cluster -n openshift-image-registry --type merge -p '{"spec":{"defaultRoute":true}}'

# oc get route -n openshift-image-registry
NAME            HOST/PORT                                                                 PATH   SERVICES         PORT    TERMINATION   WILDCARD
default-route   default-route-openshift-image-registry.apps.du-sno-3.nokia5g.redhat.lab          image-registry   <all>   reencrypt     None

// Config storage and managementState in CR config.imageregistry -n openshift-image-registry
spec:
  defaultRoute: true
  logLevel: Normal
  managementState: Managed
  replicas: 1
  rolloutStrategy: Recreate
  storage:
    managementState: Managed
    pvc:
      claim: {}

// Login Openshift Registry with token
# podman login -u developer -p $(oc whoami -t) default-route-openshift-image-registry.apps.du-sno-3.nokia5g.redhat.lab

# skopeo copy --format v2s1 --dest-creds=developer:${TOKEN} \
oci:/home/student/DO288/labs/expose-registry/ubi-info docker://${INTERNAL_REGISTRY}/${RHT_OCP4_DEV_USER}-common/ubi-info:1.0
```

## Troubleshoot application deployment issues
  - Diagnose and correct minor issues with application deployment

## Work with image streams
  - Create custom image streams to deploy applications
  - Pull applications from existing Git repositories
  - Debug minor issues with application deployment
## Work with configuration maps
- Create configuration maps

- Use configuration maps to inject data into applications
```diff
// Inject data from configmap
# oc set env deployment/mydcname --from configmap/myconf

# oc set volume deployment/mydcname --add \
     -t configmap -m /path/to/mount/volume --name myvol --configmap-name myconf

// Inject data from secret
# oc set env deployment/mydcname --from secret/mysecret

# oc set volume deployment/mydcname --add \
     -t secret -m /path/to/mount/volume --name myvol --secret-name mysecret
```

## Work with the source-to-image (S2I) tool
  - Deploy applications using S2I
  - Customize existing S2I builder images
## Work with hooks and triggers
  - Create a hook that runs a provided script
  - Test and confirm proper operation of the hook
  - Manage and trigger application builds
## Work with templates
  - Create an OpenShift template
  - Use pre-existing templates written in either JSON or YAML format
  - Work with multi-container templates
  - Add custom parameters to a template

During the exam you may be required to work with one or more pre-written applications. You will not be required to modify application code however in some cases you may need to utilize supplied documentation in order to fully test and complete the deployment of a given application.
